<!DOCTYPE html>
<html lang="en">
<head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PDJVZZZ6');</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketing Tools | John</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
</head>
<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PDJVZZZ6"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <header>
        <div class="container">
            <nav>
                <a href="index.html" class="logo">John.Dev</a>
                <div class="nav-links">
                    <a href="index.html">About</a>
                    <a href="index.html#stack">Tech Stack</a>
                    <a href="tools.html" class="active" style="color: var(--primary);">Tools</a>
                </div>
            </nav>
        </div>
    </header>

    <div class="container" style="padding-top: 120px; padding-bottom: 40px; text-align: center;">
        <h1>Marketing <span style="color: var(--primary);">Utility Belt</span></h1>
        <p style="color: var(--text-muted);">Automation tools to speed up daily workflows.</p>
    </div>

    <section class="section-padding" style="padding-top: 20px;">
        <div class="container">
            <div class="tool-wrapper">
                <div class="tool-header">
                    <span style="color: var(--primary); font-weight:bold; letter-spacing: 1px; font-size:0.8rem;">TRACKING</span>
                    <h2>UTM Campaign Builder</h2>
                    <p>Standardize your tracking parameters instantly. Matches Google's specifications.</p>
                </div>

                <form id="utmForm">
                    <div class="form-group full-width">
                        <label>Website URL *</label>
                        <input type="url" id="baseUrl" placeholder="https://www.yourdomain.com" required>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>Campaign ID (utm_id)</label>
                            <input type="text" id="utmId" placeholder="e.g. abc.123">
                        </div>
                        <div class="form-group">
                            <label>Campaign Name (utm_campaign) *</label>
                            <input type="text" id="utmCampaign" placeholder="e.g. summer_sale" required>
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>Campaign Source (utm_source) *</label>
                            <input type="text" id="utmSource" placeholder="e.g. google, newsletter" required>
                        </div>
                        <div class="form-group">
                            <label>Campaign Medium (utm_medium) *</label>
                            <input type="text" id="utmMedium" placeholder="e.g. cpc, email" required>
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label>Campaign Term (utm_term)</label>
                            <input type="text" id="utmTerm" placeholder="Identify the paid keywords">
                        </div>
                        <div class="form-group">
                            <label>Campaign Content (utm_content)</label>
                            <input type="text" id="utmContent" placeholder="Use to differentiate ads">
                        </div>
                    </div>
                </form>

                <div class="result-box">
                    <div id="finalUrl" class="generated-url">Fill in the fields to generate URL...</div>
                    <button class="copy-btn" onclick="copyToClipboard('finalUrl')" title="Copy to Clipboard">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <section class="section-padding" style="padding-top: 0;">
        <div class="container">
            <div class="tool-wrapper" style="border-color: #8B5CF6;">
                <div class="tool-header">
                    <span style="color: #8B5CF6; font-weight:bold; letter-spacing: 1px; font-size:0.8rem;">TECHNICAL</span>
                    <h2>GTM Data Layer Generator</h2>
                    <p>Generate valid JavaScript code for GA4 Ecommerce events (Purchase, AddToCart) instantly.</p>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label>Event Name</label>
                        <select id="eventName">
                            <option value="purchase">Purchase</option>
                            <option value="add_to_cart">Add to Cart</option>
                            <option value="begin_checkout">Begin Checkout</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Currency</label>
                        <input type="text" id="currency" value="EUR">
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label>Transaction ID / Order ID</label>
                        <input type="text" id="transactionId" placeholder="e.g. T_12345">
                    </div>
                    <div class="form-group">
                        <label>Total Value</label>
                        <input type="number" id="totalValue" placeholder="e.g. 59.90">
                    </div>
                </div>

                <hr style="border: 0; border-top: 1px solid var(--border); margin: 20px 0;">
                <p style="color: #fff; font-size: 0.9rem; margin-bottom: 10px;">Item Details (Single Item Example)</p>

                <div class="form-grid">
                    <div class="form-group">
                        <label>Item ID / SKU</label>
                        <input type="text" id="itemId" placeholder="e.g. SKU_999">
                    </div>
                    <div class="form-group">
                        <label>Item Name</label>
                        <input type="text" id="itemName" placeholder="e.g. Blue T-Shirt">
                    </div>
                </div>

                <div class="result-box" style="background: #1e1e1e; border-color: #333;">
                    <div style="margin-bottom: 10px; font-size: 0.8rem; color: #8B5CF6; font-family: monospace;">// Copy and paste this into console or scripts</div>
                    <pre id="codeOutput" style="color: #A5B4FC; font-family: 'Consolas', monospace; white-space: pre-wrap; word-break: break-all;">
// Code will appear here...
                    </pre>
                    <button class="copy-btn" onclick="copyToClipboard('codeOutput')" title="Copy Code">
                        <i class="fas fa-code"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p style="margin-bottom: 10px;">&copy; 2025 John. Built with custom code.</p>
            <div style="font-size: 0.85rem;">
                <a href="legal.html" style="color: var(--text-muted); text-decoration: none; margin: 0 10px;">Privacy & Terms</a>
            </div>
        </div>
    </footer>

    <script>
        // --- UTM BUILDER LOGIC ---
        const utmInputs = document.querySelectorAll('#utmForm input');
        const display = document.getElementById('finalUrl');

        function generateURL() {
            const urlVal = document.getElementById('baseUrl').value.trim();
            const source = document.getElementById('utmSource').value.trim();
            const medium = document.getElementById('utmMedium').value.trim();
            const campaign = document.getElementById('utmCampaign').value.trim();
            const id = document.getElementById('utmId').value.trim();
            const term = document.getElementById('utmTerm').value.trim();
            const content = document.getElementById('utmContent').value.trim();

            if (!urlVal) {
                display.style.color = '#94A3B8';
                display.textContent = 'Enter a valid Website URL to start...';
                return;
            }

            try {
                let finalBase = urlVal;
                if (!/^https?:\/\//i.test(finalBase)) {
                    finalBase = 'https://' + finalBase;
                }
                const urlObj = new URL(finalBase);
                
                if (source) urlObj.searchParams.set('utm_source', source);
                if (medium) urlObj.searchParams.set('utm_medium', medium);
                if (campaign) urlObj.searchParams.set('utm_campaign', campaign);
                if (id) urlObj.searchParams.set('utm_id', id);
                if (term) urlObj.searchParams.set('utm_term', term);
                if (content) urlObj.searchParams.set('utm_content', content);

                display.style.color = '#10B981';
                display.textContent = urlObj.toString();
            } catch (e) {
                display.textContent = 'Invalid URL format';
            }
        }

        utmInputs.forEach(input => input.addEventListener('input', generateURL));

        // --- GTM DATA LAYER GENERATOR LOGIC ---
        const gtmInputs = document.querySelectorAll('#eventName, #currency, #transactionId, #totalValue, #itemId, #itemName');
        const codeDisplay = document.getElementById('codeOutput');

        function generateDataLayer() {
            const eventName = document.getElementById('eventName').value;
            const currency = document.getElementById('currency').value || 'EUR';
            const transId = document.getElementById('transactionId').value || 'T_12345';
            const value = document.getElementById('totalValue').value || 0;
            const itemId = document.getElementById('itemId').value || 'SKU_123';
            const itemName = document.getElementById('itemName').value || 'Product Name';

            // Construct the Object
            const dlObject = {
                event: eventName,
                ecommerce: {
                    currency: currency,
                    value: parseFloat(value),
                    transaction_id: transId,
                    items: [
                        {
                            item_id: itemId,
                            item_name: itemName,
                            price: parseFloat(value) // Simplified for single item example
                        }
                    ]
                }
            };

            // Remove transaction_id if not purchase
            if(eventName !== 'purchase') {
                delete dlObject.ecommerce.transaction_id;
            }

            // Convert to formatted string
            const jsonString = JSON.stringify(dlObject, null, 4);
            codeDisplay.textContent = `window.dataLayer.push(${jsonString});`;
        }

        gtmInputs.forEach(input => input.addEventListener('input', generateDataLayer));
        // Run once on load
        window.addEventListener('load', generateDataLayer);


        // --- GENERIC COPY FUNCTION ---
        function copyToClipboard(elementId) {
            const textToCopy = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(textToCopy).then(() => {
                alert("Copied to clipboard!");
            });
        }
    </script>
</body>
</html>
